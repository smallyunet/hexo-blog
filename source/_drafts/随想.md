---
title: 随想
draft_date: 2021-11-23 00:43:21
tags:
- Golang
- RESTful API
---

现在是凌晨快 1 点，睡不着，稍微写写。今天白天（昨天），测试提醒我，REST 接口的输入参数应该以大写字母开头。

我一开始还紧张了一下，我 out 了？我没有按照该有的规范开发？REST 接口的参数大写开头？（接口的 `Content-Type` 是 `application/json`）

然后就去查了一下 Github 的 API 文档，又看了一眼 DIDs (Decentralized Identifiers) 的标准文档，以及结合我长时间接触使用 json 的经验，没有啊，json 的 key，哪有大写字母开头的习惯？

后来想到了一个吐血的原因，就问了一句，“参数首字母大写，是公司的规范吗？”。测试回复的原话是：

> 我之前问过，就是你们开发自己都这么写，好像是，公有变量还是私有变量，就要首字母大写

果然是。（微笑）

#### 权限控制

Java 里的权限修饰符是很基础的概念，用来控制类的访问权限，一共有 3 个关键词、4 种情况，比如 `public` 表示公开，`private` 表示私有：

``` Java
public class aaa {
    public int a;
    private String b;
}
```

更多内容可以参考 Java 的文档： [Controlling Access to Members of a Class](https://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)

像 Python 那样的脚本语言本身没有访问权限控制的概念，所以约定俗成地认为以 `__` 开头命名的变量是私有的，不过没有代码层面的保护，只是命名上的区别。参考：[Does Python have “private” variables in classes?](https://stackoverflow.com/questions/1641219/does-python-have-private-variables-in-classes)

众所周知，Golang 是一种奇葩的语言，不但要求你大括号必须写在函数名同一行，还会要求你必须做一些什么事情，比如，大写字母开头的变量意味着公开，小写字母开头的变量意味着私有。

Golang 对变量大小写的区分，可不仅仅是命名上的区别，而是代码层面的控制。下面的代码会输出什么？

``` Golang
func main() {
	a := struct {
		i int
	}{
		i: 1,
	}
	s, _ := json.Marshal(a)
	fmt.Println(string(s))
}
```

当然是 `{}`，由于 `i` 是小写的，在 marshal 的时候自动忽略了。

这其实算是比较不正常的要求了。Golang 为了设计上的 “简洁”，很大程度上减少关键字、关键字复用，但是又不得不提供某些能力，就需要一些奇怪的方式做变通。 

我在上面的 Java 代码中，刻意用了小写的 `aaa` 做类名。Java 的类一般使用大写字母开头，但是不会在代码层面限制你把代码写成什么样子。

虽然我工作使用 Golang，但我不是它的教徒，当然，也不是其他语言的教徒。如果你仍然是某种语言的教徒，祝愿你可以尽早改变一下观念。

所以，由于 Golang 的一些 “特性”，为了在序列化的时候方便一点，项目的 REST 接口就习惯于使用大写字母开头的变量名作为 key 了。

睡觉了，明天再写。
