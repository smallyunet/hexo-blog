<!DOCTYPE html><html lang="zh-cn"><head><title>课程手记 · Hello，移动web</title><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=0.5"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/site.webmanifest"><link rel="stylesheet" href="/css/highlight/xcode.min.css"><link rel="stylesheet" href="/css/bootstrap/bootstrap-tooltips.css"><link rel="stylesheet" href="/css/post.css"><script src="/js/jquery.min.js"></script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="smallyu的博客（疯狂版）" type="application/atom+xml">
</head><body><script>if (/mobile/i.test(navigator.userAgent) || /android/i.test(navigator.userAgent)) {
  document.body.classList.add('mobile')
  var navbar = document.querySelector('nav.navbar');
  if (navbar) {
    navbar.classList.remove('navbar-fixed-top');
  }
}
</script><div><div class="inner"><h1>课程手记 · Hello，移动web</h1><div class="time">2016-10-18</div><ul class="tags"><li><span>#</span><a href="/tags/移动web/">移动web</a></li></ul><p>内容来自慕课网WebApp开发课程的内容，看完之后回想起来，确实有必要记录一下，便于温故</p>
<p>课程地址：<a href="http://www.imooc.com/learn/494">http://www.imooc.com/learn/494</a></p>
<p><strong>Pixel移动开发像素基础</strong>  </p>
<p>px: CSS pixels 逻辑像素，浏览器使用的抽象单位</p>
<p>dp,pt: device independent pixels 设备无关像素</p>
<p>dpr: devicePixelRatio 设备像素缩放比</p>
<p>计算公式：1px &#x3D; (dpr)^2 * dp</p>
<p>DPI: 打印机每英寸可以喷的墨汁点（印刷行业）</p>
<p>PPI: 屏幕每英寸的像素数量，即单位英寸内的像素密度</p>
<p>目前，在计算机显示设备参数描述上，二者意思表达的是一样的（单位为硬件像素，非px）</p>
<p>PPI越高，像素数越高，图像越清晰，但可视度越低（小），系统默认设置缩放比越大</p>
<img src="201610181476787434192242.png" alt="屏幕快照 2016-10-18 下午10.23.22.png" title="屏幕快照 2016-10-18 下午10.23.22.png" />

<p>Retina屏（高清屏）dpr都是大于等于2</p>
<p><strong>Viewport视图</strong>  </p>
<p>思考下面一个问题：</p>
<img src="201610181476787435437480.png" alt="屏幕快照 2016-10-18 下午10.30.28.png" title="屏幕快照 2016-10-18 下午10.30.28.png" />

<p>手机浏览器默认为我们做了两件事情：</p>
<p>一：页面渲染在移动设备分辨率大小的viewport</p>
<p>二：缩放</p>
<p>为什么渲染时，要有Viewport？</p>
<p>为了排版正确。</p>
<p>viewport有两个，visual viewport和layout viewport</p>
<img src="201610181476787434971290.png" alt="屏幕快照 2016-10-18 下午10.36.56.png" title="屏幕快照 2016-10-18 下午10.36.56.png" />

<p>Viewport Meta标签</p>
<pre><code>&lt;meta name=&quot;viewport&quot; content=&quot;name1=value1,name2=value2&quot;&gt;
</code></pre>
<p>width: 设置布局viewport的特定值（”device-width”）</p>
<p>initial-scale: 设置页面的初始缩放</p>
<p>minimum-scale: 最少缩放</p>
<p>maximum-scale: 最大缩放</p>
<p>user-scalable: 用户能否缩放</p>
<p>常用写法：</p>
<pre><code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,inital-scale=1,user-scalable=no&quot;&gt;
</code></pre>
<p><strong>Flex弹性盒子布局</strong>  </p>
<pre><code>.nav&#123;display:-webkit-flex;&#125;/*父元素*/

.item&#123;flex:1&#125;/*子元素*/
</code></pre>
<p>display:-webkit-flex 标示使用弹性布局</p>
<p>flex:num 占容器的比例</p>
<img src="201610181476787435453961.png" />

<p>Flex不定宽高的水平垂直居中</p>
<pre><code>.parent&#123;

    justify-content:center;/*子元素水平居中*/

    align-items:center;/*子元素垂直居中*/

    display:-webkit-flex;

&#125;
</code></pre>
<p><strong>Web的Flex弹性盒模型</strong>  </p>
<p><a href="web/web_flex.html">http://oldblog.smallyu.net/web/web_flex.html</a></p>
<p>访问这个链接查看flex的所有属性案例</p>
<p><strong>响应式设计</strong>  </p>
<p>兼容性</p>
<p>·iOS可以使用最新的flex布局</p>
<p>·android4.4以下，只能兼容旧版的flexbox布局</p>
<p>·android4.4及以上，可以使用最新的flex布局</p>
<img src="201610181476787435416462.png" alt="屏幕快照 2016-10-18 下午11.15.51.png" title="屏幕快照 2016-10-18 下午11.15.51.png" />

<p>媒体类型</p>
<p>screen（屏幕）</p>
<p>print（打印机）</p>
<p>handheld（手持设备）</p>
<p>all（通用）</p>
<p>常用该媒体查询参数：</p>
<p>width—视口宽高</p>
<p>height——视口宽高</p>
<p>device-width——设备的宽度</p>
<p>device-height——设备的高度</p>
<p>orientation：检查设备处于横向（landscape）还是竖屏（portrait）</p>
<p><strong>设计点一：百分比布局</strong></p>
<p>仅仅使用媒体查询来适应不同的固定宽高设计，只会从一组css到另一组css的切换。两种之间没有任何平滑渐变。当没有命中媒体查询时，表现就会变得不可控制（滚动，换行）。</p>
<p><strong>设计点二：弹性图片</strong></p>
<p>很简单，如同多一点布局使用百分比，图片也使用百分比。其背后的思路是：无论何时，都全包在图片的元素宽度范围内，以最大的宽度同比完整的显示图片。</p>
<p><strong>设计点三：重新布局，显示与隐藏</strong></p>
<p>当页面达到屏幕手机宽度的时候，很多时候就要放弃一些传统的页面设计思想。力求页面简单，简介。所以我们必须要做出以下处理：</p>
<p>1.同比例缩减元素尺寸</p>
<p>2.调整页面结构布局</p>
<p>3.隐藏冗余的元素</p>
<p><strong>移动web特别样式处理</strong>  </p>
<p>高清图片</p>
<p>在移动web也页面上渲染图片，为了避免图片产生模糊，图片的宽高应该用物理像素单位渲染，即是100<em>100的图片，应该使用100dp</em>100dp</p>
<p>width:(w_value&#x2F;dpr)px;</p>
<p>height:(h_value&#x2F;dpr)px;</p>
<p>一像素边框</p>
<p>同样是retina屏幕下的问题，根本原因：1px使用2dp渲染</p>
<p>border:0.5px (FALSE) 仅仅ios8可以用</p>
<p>sacleY(.5)</p>
<p>相对单位rem</p>
<p>为了是一个各大屏幕的手机，px略显固定，不能根据尺寸的大小而改变，使用相对单位更能体验页面兼容性</p>
<p>em：根据父节点的font-size为相对单位</p>
<p>rem：是根据html的font-size为相对单位</p>
<p>em在多层嵌套下，变得非常难以为何</p>
<p>rem更加能作为全局统一设置的度量</p>
<p>rem的基值设置为多少好？</p>
<p>为了使用各大手机屏幕，rem&#x3D;screen.width&#x2F;20</p>
<p>不使用rem的情况：font-size</p>
<p>多行文本溢出</p>
<p>单行文本溢出，对title类的使用非常多，而多行文本溢出，在详情介绍则使用的比较多</p>
<p>终端交互优化</p>
<p><strong>Tap基础事件</strong>  </p>
<p>300毫秒的故事</p>
<p>移动web页面上的click时间响应都要慢上300毫秒。移动设备访问的web页面都是pc上的页面。在默认的viewport（980px）的页面往往都是需要“双击”或“捏开”放大页面，来看高清页面。而正是为了确认用户是“双击”还是“单击”，safari需要300ms的延迟来判断。</p>
<p>300ms延迟怎么破？</p>
<p>使用Tap时间来代替click事件</p>
<p>自定义Tap事件原理：</p>
<p>在touchstart、touchend时记录时间、手指位置，在touchend时进行比较，如果手指位置为同一位置（或允许移动一个非常小的位移值）且时间间隔比较短（一般认为是200ms），且过程中未曾触发过touchmove，即可认为触发了手持设备上的“click”，一般称它为“tap”。(移动框架库Zepto.js)</p>
<p>Tap“点透”的bug</p>
<img src="201610181476787436121082.png" alt="屏幕快照 2016-10-18 下午11.57.12.png" title="屏幕快照 2016-10-18 下午11.57.12.png" />

<p>看过这个过程应该可以秒懂“点透”</p>
<p>Tap透传的解决方案</p>
<p>1.使用缓动动画，过度300ms的延迟</p>
<p>2.中间层dom元素的假如，让中间层接受这个“穿透”</p>
<p>3.“上下”都使用tap时间，原理上解决tap透传事件（但不可避免原生标签click事件）</p>
<p>4.改用Fastclick的库（听过最新的zepto已经fixed掉这个bug）</p>
<p><strong>触摸Touch</strong>  </p>
<p>Touch基础事件</p>
<p>触摸才是移动设备的交互的核心事件</p>
<p>touchstart：手指触摸屏幕触发（已经有手指放屏幕上不会触发）</p>
<p>touchmove：手指在屏幕滑动，连续触发</p>
<p>touchend：手指离开屏幕时触发</p>
<p>touchcancel：系统取消touch时候触发（不常用）</p>
<p>除常见的事件属性外，触摸事件包含专有的触摸属性</p>
<p>touches：跟踪触摸操作的touch对象数组</p>
<p>targetTouches：特定时间目标的touch对象数组</p>
<p>changeTouches：上次触摸改变的touch对象数组</p>
<p>每个touch对象包含属性：</p>
<p>clientX：触摸目标在视口中的x坐标</p>
<p>clientY：触摸目标在视口中的y坐标</p>
<p>identifier：表示触摸的唯一ID。</p>
<p>pageX：触摸目标在页面中的x坐标（包含滚动）。</p>
<p>pageY：触摸目标在页面中的y坐标（包含滚动）。</p>
<p>screenX：触摸目标在屏幕中的x坐标。</p>
<p>screenY：触摸目标在屏幕中的y坐标。</p>
<p>target：触摸的DOM节点目标。</p>
<p>根据touch对象跟踪触摸具体位置，从而判断触摸交互或手势事件。</p>
<p>BUG</p>
<p>Android只会触发一次touchstart，一次touchmove，touchend不触发</p>
<p>解决方案</p>
<p>在touchmove中加入：enevt.preventDefault()。</p>
<p>但注意</p>
<p>enevt.preventDefault()会导致默认行为不发生，如scroll，导致页面不滚动。</p>
<p>弹性滚动</p>
<p>当客户端的页面滚动到顶部或底部的时候，滚动条会收缩并让我们多滑动一定距离。通过缓冲反弹的效果，带给用户良好的体验。</p>
<p>移动web页面也是拥有这样能力的，但滚动有几种情况需要考虑：</p>
<p>body层滚动：（系统特殊化处理）</p>
<p>再带弹性滚动，overflow：hidden失效，GIF和定时器暂停</p>
<p>局部滚动开启弹性滚动：</p>
<pre><code>body&#123;

    overflow:scroll;

    -webkit-over-scrolling:touch;

&#125;
</code></pre>
<p>注意Android不支持原生的弹性滚动！但可以借助三方库iScroll来实现</p>
<p>下拉刷新</p>
<p>顶端下拉一小点距离，页面弹性滚动向下</p>
<p>上拉加载</p>
<p>使用scroll事件而不是touch时间（android有bug）</p>
<p><strong>总结</strong></p>
<img src="201610181476787436203666.png" alt="屏幕快照 2016-10-18 下午11.59.26.png" title="屏幕快照 2016-10-18 下午11.59.26.png" />
</div></div></body><script src="/js/highlight.min.js"></script><script src="/js/main.js"></script><script src="/js/bootstrap/bootstrap.min.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-Y7C0CVX9PK"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-Y7C0CVX9PK');</script></html>